#!/usr/bin/python3

import math
import sys
from numpai import HMM, Matrix
import numpy as np

OBS_1k = "1000 0 3 3 2 1 0 2 3 0 0 2 3 0 0 2 3 0 0 0 0 1 2 2 3 1 3 0 2 3 1 2 3 1 3 3 1 2 0 3 1 2 2 2 1 1 1 0 2 0 3 2 3 2 1 1 2 3 1 2 1 2 1 2 1 1 3 3 1 1 2 3 0 0 1 1 2 3 1 1 0 1 1 1 1 1 3 3 1 1 3 0 0 3 1 3 1 3 3 2 1 3 3 2 3 3 3 1 1 1 1 2 1 3 3 3 0 1 0 0 3 3 2 2 3 3 3 2 1 0 0 3 3 1 0 2 2 2 0 0 2 3 1 1 1 2 2 3 3 1 1 0 0 1 2 0 0 2 0 1 1 0 0 0 0 3 3 1 2 0 0 2 3 2 2 0 1 1 3 1 1 0 3 3 0 3 3 3 2 3 2 3 1 2 1 2 0 0 0 0 3 0 3 3 3 3 1 1 3 2 1 2 0 3 3 3 3 3 3 0 0 2 3 2 1 1 1 3 2 2 2 1 2 1 1 2 3 1 2 3 1 1 1 3 3 2 2 2 1 0 2 2 1 0 3 2 2 3 1 0 1 2 2 2 0 3 1 2 0 3 0 0 3 1 2 2 3 1 1 0 2 2 1 3 2 3 1 0 0 0 2 1 3 3 0 1 0 3 0 2 0 0 3 2 3 3 3 2 3 2 3 1 3 3 0 1 0 2 2 1 2 3 3 1 3 2 3 3 3 1 2 1 3 0 1 2 0 1 3 3 3 3 2 1 1 1 1 3 3 1 1 3 3 2 0 1 0 0 0 0 0 1 0 0 0 1 0 0 0 0 2 0 2 0 3 1 3 1 3 2 0 0 0 0 0 1 2 3 0 1 1 0 2 3 2 1 0 2 1 2 2 2 1 1 2 2 1 3 3 3 3 1 3 1 0 2 1 2 1 3 1 1 3 0 0 1 0 1 3 3 2 2 1 2 3 2 1 2 1 1 1 0 0 0 2 2 2 1 3 3 1 1 2 2 1 1 2 3 1 2 1 0 0 3 2 1 3 2 2 3 0 0 3 3 0 3 0 0 1 0 0 2 3 1 0 0 0 1 2 2 3 2 3 1 0 2 2 3 3 1 1 2 1 1 1 3 2 2 3 2 0 3 3 0 0 0 0 0 0 0 0 2 2 3 3 3 2 3 2 1 3 0 2 1 2 0 0 0 2 3 2 2 2 1 3 3 2 1 2 0 0 3 2 1 2 3 1 0 1 3 3 3 2 2 0 0 0 2 2 3 1 1 3 0 0 3 0 0 3 0 1 3 0 3 0 0 0 0 0 0 0 0 3 2 3 1 2 3 0 3 3 2 0 3 2 1 1 0 1 0 0 0 0 2 3 3 3 1 1 3 1 2 3 0 3 3 3 0 0 1 1 0 3 2 2 3 1 1 3 1 1 3 2 0 2 0 0 2 0 0 0 1 0 1 1 0 0 0 0 0 2 2 3 3 1 3 3 3 1 0 2 3 3 3 0 1 1 1 1 0 0 3 3 3 2 3 2 3 3 2 3 3 3 3 3 2 2 1 3 1 0 1 1 1 0 3 1 0 0 3 3 2 2 2 3 3 1 1 1 2 1 3 2 1 1 2 3 2 2 1 2 2 1 1 2 1 0 0 1 2 1 2 1 1 2 0 0 3 2 3 2 1 1 3 2 3 3 3 0 2 0 3 3 1 1 1 2 2 0 0 0 0 0 1 1 1 3 2 3 2 0 0 3 2 3 1 2 0 3 2 1 2 1 0 1 1 1 2 2 2 2 2 3 3 2 3 2 1 3 3 2 2 2 1 0 1 3 2 1 0 3 2 2 1 1 3 3 3 3 1 0 3 3 3 2 3 3 2 3 0 1 0 1 2 2 1 2 1 2 3 3 3 0 1 2 2 3 1 1 0 3 2 2 1 1 0 0 1 0 0 0 1 1 0 0 0 0 2 0 0 0 3 3 0 0 3 1 2 2 1 0 0 2 2 3 0 3 0 3 2 2 3 3 2 0 2 3 0 0 3 1 0 0 1 2 0 0 3 3 1 1 3 2 3 1 3 3 1 3 3 3 2 3 1 0 1 3 2 1 2 3 3 0 2 0 0 1 0 3 2 0 2 3 1 3 1 1 2 1 1 2 2 1 1 3 2 2 0 0 1 1 0 0 0 2 2 0 0 3 2 2 1 2 3 3 0 0 2 0 0 0 3 3 3 2 0 1 0 1 1 3"

OBS_10k = "10000 2 2 3 0 1 2 3 1 2 1 3 2 0 2 1 0 3 2 1 0 1 0 0 0 1 0 3 3 2 1 0 0 0 0 0 0 2 0 0 2 3 2 3 0 0 0 1 3 1 0 2 1 0 0 3 1 3 1 0 0 2 0 0 0 0 0 1 0 0 0 0 3 3 2 3 1 2 2 2 1 3 2 0 3 3 2 1 2 1 0 1 3 1 1 1 1 2 1 1 2 2 1 0 0 0 3 0 3 3 0 0 0 0 1 3 3 1 3 3 1 2 1 3 3 3 3 2 2 0 0 1 1 3 3 3 0 2 0 0 1 1 0 0 1 0 2 0 1 0 3 2 3 0 1 0 2 2 3 3 1 3 3 1 0 2 1 0 3 0 1 1 0 2 2 3 2 3 1 3 3 3 3 0 3 3 2 2 1 3 3 1 3 2 2 2 1 1 2 2 1 0 0 1 3 3 3 2 3 0 0 0 0 1 1 0 0 0 2 3 3 3 1 1 0 0 1 1 1 0 0 3 2 3 0 0 0 0 2 1 0 0 0 3 3 1 1 0 3 3 1 3 3 2 2 0 1 1 0 1 1 1 3 3 2 3 3 3 3 1 1 1 1 1 3 3 1 1 2 3 0 0 0 0 0 0 3 3 0 3 2 3 3 2 3 3 3 2 3 3 0 0 1 0 1 3 2 0 0 0 1 0 3 1 3 2 0 1 3 1 3 2 3 2 3 1 3 3 2 0 1 3 2 2 3 0 2 0 0 0 2 0 0 0 3 0 1 0 1 1 1 0 1 1 0 0 0 1 0 3 3 3 2 3 3 1 0 1 0 1 0 1 1 2 3 1 3 3 0 3 1 2 2 3 3 3 2 1 2 2 0 0 0 2 3 3 2 2 1 3 3 2 2 1 1 3 3 3 3 3 1 1 1 2 1 2 2 1 0 0 3 3 1 1 1 2 2 3 3 0 2 3 0 0 1 1 1 1 1 2 2 2 2 1 3 0 1 3 2 0 1 3 1 1 1 1 2 0 0 1 0 0 1 2 1 1 1 3 1 0 2 1 0 2 0 0 0 0 0 1 1 0 0 2 1 1 0 1 1 0 3 1 3 1 1 0 1 0 3 1 2 2 2 0 2 3 0 0 1 2 0 3 3 2 1 1 2 0 0 0 0 2 3 1 2 2 2 0 0 1 1 1 1 3 3 1 2 1 1 0 3 3 3 0 0 1 1 1 1 0 1 1 1 3 1 1 1 3 2 2 2 1 3 0 1 3 3 3 3 2 2 1 1 2 2 2 2 0 1 0 1 1 3 1 3 2 3 3 2 3 3 2 0 1 2 2 3 2 3 1 2 1 1 1 0 2 1 3 2 0 3 1 3 3 1 1 1 1 1 3 1 1 0 0 3 3 0 0 0 0 0 2 3 2 3 1 1 3 1 2 3 1 2 0 3 3 3 2 3 2 0 1 0 1 3 3 3 1 2 0 2 3 3 1 1 2 1 1 2 0 1 0 3 2 2 1 2 1 1 0 1 2 3 2 3 2 3 2 1 2 1 1 1 3 3 2 0 3 1 2 0 0 0 1 1 1 0 2 2 3 3 1 3 0 1 3 0 1 2 3 3 0 1 1 1 0 3 2 2 3 1 3 2 3 0 0 0 1 3 3 1 2 0 3 2 3 0 2 3 1 1 0 0 1 1 3 2 1 2 1 2 2 1 1 3 3 1 2 2 1 3 2 0 0 0 1 3 1 3 1 1 2 3 3 2 0 0 0 0 0 3 2 2 2 2 3 1 2 3 3 0 0 1 0 2 0 1 2 1 1 1 0 2 2 0 0 0 3 1 0 0 1 1 0 3 1 2 3 1 1 2 2 1 3 1 3 1 0 1 2 3 2 1 3 1 2 2 0 1 0 2 1 0 0 0 1 1 1 0 1 2 1 1 3 1 1 3 2 3 2 2 1 1 1 3 1 1 2 3 2 1 2 3 3 2 3 3 3 3 2 0 0 2 2 2 1 3 3 0 3 1 1 1 0 0 1 1 1 2 2 2 3 3 3 2 1 2 1 0 0 2 3 3 1 1 0 2 1 0 2 1 0 0 3 1 2 2 3 3 1 2 2 1 1 0 0 0 3 2 1 2 3 2 0 0 2 0 0 2 2 2 3 3 2 0 0 0 2 1 2 1 1 2 0 3 3 3 2 1 1 1 2 3 1 3 3 1 1 3 3 1 2 3 3 0 1 1 2 3 1 0 1 3 1 3 2 0 0 1 0 0 2 0 0 3 2 3 0 1 3 0 3 3 1 0 2 1 2 1 3 2 1 2 2 2 3 3 2 0 0 0 1 0 0 0 3 1 1 2 0 2 3 2 2 2 3 3 3 0 3 0 0 0 0 0 3 1 3 2 2 1 2 0 2 0 0 0 2 2 3 3 0 2 3 2 3 3 3 0 0 0 2 0 0 0 0 0 1 0 0 0 3 1 3 2 2 0 2 3 3 3 1 1 1 1 1 2 1 0 3 3 1 3 2 0 3 0 0 0 3 2 2 3 1 2 3 3 3 0 1 0 0 0 0 0 2 2 1 1 0 1 0 1 3 3 1 0 0 3 1 3 0 2 3 3 3 2 2 1 0 0 3 3 0 0 3 2 3 1 3 1 2 0 1 3 3 2 2 3 1 2 2 1 0 0 1 2 3 1 2 2 3 0 3 3 2 0 1 0 0 1 3 1 2 1 2 3 1 0 0 3 2 0 2 2 1 3 1 2 1 2 2 1 2 1 3 3 3 3 2 2 1 0 3 3 3 0 2 1 0 3 1 0 1 1 3 0 0 0 0 1 0 0 2 0 0 0 1 0 1 3 0 2 2 3 3 3 0 1 3 1 2 1 1 2 2 2 3 2 0 0 2 0 0 0 2 0 0 1 1 3 2 0 0 0 0 0 0 0 3 2 3 1 0 2 0 2 3 2 0 0 0 1 3 3 0 1 0 1 1 0 2 0 3 2 0 1 2 1 2 3 2 0 3 1 1 1 0 3 1 1 2 0 0 0 0 0 0 0 3 3 1 1 3 1 0 2 1 3 0 3 0 0 1 1 1 1 2 0 3 2 2 3 3 1 0 2 2 3 2 0 2 1 0 0 0 2 3 1 1 2 1 3 3 1 1 1 3 2 1 1 1 1 3 3 0 3 3 3 1 2 1 1 0 3 3 3 3 1 1 2 3 3 3 1 1 1 1 2 1 0 2 2 1 1 0 0 0 0 2 0 0 0 0 0 2 0 0 1 3 2 2 1 2 0 1 0 0 2 1 2 3 1 3 3 1 1 1 2 1 0 1 0 3 1 3 1 1 1 0 3 1 0 2 1 2 0 1 3 3 2 1 2 1 3 0 2 0 0 3 2 1 1 1 0 0 2 0 0 0 0 0 1 0 3 1 1 0 1 1 1 0 0 0 1 1 3 2 2 3 3 1 2 1 0 3 3 3 1 1 2 0 2 3 3 3 3 2 3 2 1 0 1 3 3 3 0 0 0 0 0 0 0 0 2 3 3 1 0 1 3 1 3 3 1 3 1 3 3 1 1 0 2 2 1 2 3 2 0 0 2 0 1 1 1 1 3 3 2 2 1 1 1 1 1 1 0 3 3 2 3 1 2 2 3 2 3 3 1 1 0 1 3 2 0 1 2 3 1 2 2 2 1 2 1 3 2 1 2 2 1 1 2 2 1 3 1 0 1 1 0 3 1 3 3 2 3 1 1 0 2 0 3 2 0 2 1 3 1 0 2 2 3 2 3 2 3 3 3 3 3 1 0 0 3 3 3 1 1 0 0 0 1 0 0 1 0 2 0 0 2 1 3 2 3 1 1 3 2 0 1 1 1 3 2 2 3 3 3 0 3 3 1 3 1 2 3 2 3 0 3 1 1 1 0 1 1 3 1 2 0 0 2 1 3 3 3 1 2 2 1 3 1 1 1 1 1 2 0 0 0 0 0 1 0 1 3 0 2 2 0 1 2 0 0 1 0 2 2 0 1 2 3 3 2 1 3 0 3 0 3 3 3 1 3 1 3 2 2 1 0 0 1 0 1 3 2 0 1 0 3 3 2 1 3 1 2 3 3 0 1 1 3 1 1 3 0 3 3 1 3 1 0 2 3 3 3 1 3 0 1 2 0 0 0 0 2 2 2 2 2 1 2 1 0 2 0 1 1 2 0 1 1 1 0 0 3 3 3 1 3 0 2 2 3 2 1 0 2 0 0 0 2 3 1 1 3 2 1 2 3 2 0 1 2 1 1 1 0 1 3 2 1 1 1 0 0 1 0 0 0 1 0 0 3 0 2 2 1 0 0 1 3 0 0 0 1 0 3 0 0 0 0 1 3 1 1 0 1 3 1 0 2 1 2 1 0 0 1 1 1 2 1 3 3 3 0 2 0 0 1 2 0 0 0 0 0 1 3 0 0 2 2 2 2 2 0 1 0 3 1 0 0 1 2 1 1 1 3 3 0 1 0 0 0 0 0 2 2 1 3 3 3 1 1 1 0 0 0 3 3 3 2 0 1 3 2 3 3 1 1 1 3 2 3 2 0 1 1 2 0 1 2 2 1 0 1 1 3 2 1 2 1 2 1 2 3 2 3 3 3 3 3 1 1 2 3 1 1 1 0 0 3 3 2 0 3 3 3 2 3 3 3 0 3 1 2 1 1 0 0 1 1 3 3 1 1 1 1 3 2 3 2 0 0 3 1 0 0 2 0 1 3 2 1 0 2 2 3 2 2 3 3 3 3 0 0 0 3 3 3 2 2 1 2 1 2 0 0 1 0 3 3 3 3 2 2 2 3 3 0 1 1 2 0 0 3 0 0 2 0 0 0 3 3 3 1 3 3 1 2 1 0 0 0 1 3 1 1 1 2 2 2 1 3 1 0 0 1 2 0 2 2 3 1 1 1 1 3 0 3 1 0 3 1 2 3 3 3 0 3 1 0 1 1 1 2 3 1 0 3 2 3 1 3 1 3 2 1 1 1 1 2 1 1 0 0 0 0 0 0 3 0 1 0 0 0 0 3 3 0 3 2 1 3 1 3 2 2 0 0 1 1 2 1 0 0 1 3 0 0 0 0 0 2 2 2 0 1 2 2 3 3 0 2 0 3 2 1 1 1 3 3 3 3 2 2 1 0 0 1 3 1 3 0 1 2 1 1 3 1 0 1 0 0 2 3 0 3 2 0 0 1 0 0 0 1 0 2 1 1 1 3 2 2 1 3 2 1 1 2 3 0 2 2 3 2 1 2 0 0 2 1 1 1 2 1 0 3 1 1 3 2 3 1 3 3 1 0 1 1 0 1 1 0 3 3 2 3 2 0 0 1 0 0 0 0 0 0 1 0 2 1 1 2 2 3 0 2 1 3 1 0 1 0 2 0 0 2 2 2 0 1 0 3 2 2 1 3 1 0 0 0 3 1 2 0 3 3 3 1 0 0 0 0 3 3 3 3 0 0 1 0 0 3 3 3 3 0 0 1 1 3 1 2 3 1 1 3 2 1 3 2 3 1 0 0 2 1 2 0 0 0 1 1 2 3 0 0 3 0 3 1 3 3 2 3 0 0 3 2 3 0 0 0 2 0 1 2 1 0 0 2 2 0 1 3 3 3 3 2 3 2 2 3 1 0 3 1 2 1 3 3 1 3 1 2 0 2 0 0 1 1 1 2 0 3 0 1 3 1 0 0 0 0 0 3 1 3 0 3 0 2 3 0 1 1 0 3 0 2 2 3 1 0 0 0 3 0 1 3 3 0 3 1 3 1 3 3 0 3 3 3 3 1 2 1 0 1 3 1 2 3 1 1 1 1 0 2 0 0 0 1 3 1 2 1 3 1 3 2 3 3 3 3 3 1 2 2 3 3 2 0 0 0 0 0 0 0 1 0 0 0 0 0 2 2 0 0 0 3 0 3 2 0 0 3 1 1 1 1 3 3 3 3 3 0 0 1 0 0 0 0 0 2 3 1 0 2 3 3 1 1 1 1 0 2 1 0 3 1 2 2 1 2 1 2 2 1 3 2 3 2 3 1 3 3 3 1 0 3 1 1 0 1 1 1 0 0 1 2 2 3 0 2 1 1 1 0 0 1 2 3 3 3 1 3 1 2 0 0 0 0 0 1 0 3 0 0 2 0 0 1 3 1 0 1 0 0 0 3 3 1 3 3 1 0 0 0 0 0 1 1 0 0 0 0 0 0 2 0 0 0 3 2 2 0 3 2 1 2 2 1 1 3 0 3 1 2 1 0 1 2 3 3 2 1 0 1 0 1 3 3 0 0 1 0 0 0 3 3 2 2 1 3 2 2 0 1 0 3 2 3 1 0 1 3 2 2 0 2 2 1 2 1 3 0 3 0 0 1 3 3 3 3 1 2 2 2 1 1 0 0 0 0 3 3 3 1 2 0 1 2 3 1 2 3 0 1 2 2 3 3 2 3 2 1 0 0 0 0 0 0 3 1 1 0 1 0 0 0 1 1 3 0 2 2 2 2 2 1 2 1 1 3 1 1 1 3 3 0 2 1 0 1 0 1 1 3 2 3 1 1 3 2 2 1 2 1 3 2 1 0 3 2 1 2 1 1 3 2 3 3 1 1 2 1 0 1 1 3 2 0 0 1 3 0 1 1 3 3 3 3 1 0 0 3 3 2 1 0 1 2 2 3 3 0 0 0 0 0 0 0 0 0 3 0 1 3 0 0 2 2 0 0 0 0 0 3 3 3 3 2 2 1 2 1 1 0 2 3 1 0 0 1 2 2 1 3 1 2 3 2 3 2 2 3 2 0 1 2 1 3 2 3 3 2 3 1 1 2 2 2 1 3 2 1 3 2 0 3 1 2 1 3 2 3 3 2 3 2 1 1 1 0 0 0 0 0 2 2 1 3 2 3 3 1 0 0 0 1 0 0 2 0 1 3 2 0 1 1 0 0 2 0 1 2 1 0 0 0 0 0 0 3 1 1 1 3 2 1 2 3 2 3 3 3 2 0 1 0 2 2 2 2 1 2 3 3 3 3 3 2 1 3 1 1 0 3 2 3 1 1 0 2 3 2 0 3 1 1 1 2 0 1 1 0 3 3 1 1 0 0 3 1 0 3 1 0 0 0 0 0 0 0 0 0 0 0 3 3 3 2 3 3 3 3 1 3 3 2 2 3 1 2 0 1 3 0 0 0 0 1 0 1 1 3 2 0 2 2 0 0 0 1 0 0 0 3 0 0 0 3 2 3 2 1 3 2 0 3 2 1 2 2 1 0 1 2 0 0 3 3 3 1 3 3 3 3 1 1 1 0 3 3 1 1 0 1 0 0 0 0 0 1 3 3 0 1 3 3 1 0 0 3 3 3 3 1 1 1 2 1 1 0 1 3 1 0 0 0 3 3 2 3 3 0 2 1 1 1 2 2 3 1 2 2 1 3 3 0 3 3 3 3 2 3 0 2 1 1 1 0 0 2 0 0 1 0 1 1 0 0 3 2 1 2 3 1 3 1 0 1 1 0 3 2 0 2 2 0 0 0 0 2 1 2 3 2 1 1 3 0 0 0 3 0 1 2 1 3 2 1 3 0 3 3 1 0 3 1 1 1 1 1 2 0 2 1 3 1 1 1 3 2 2 3 3 0 3 3 1 3 1 1 1 1 2 1 2 0 3 1 2 0 3 2 1 3 3 0 2 3 0 3 3 0 1 2 3 1 0 1 3 0 1 2 2 2 1 2 2 1 3 3 3 3 2 3 3 1 0 0 0 3 2 1 1 2 2 0 3 2 2 2 2 0 0 0 2 3 2 0 3 2 0 2 2 2 0 1 2 1 1 1 1 0 0 0 0 0 0 1 0 0 3 3 1 0 3 3 0 0 0 0 0 3 0 2 1 1 1 2 2 0 0 0 0 1 0 2 2 3 3 0 3 2 2 2 1 3 2 1 3 1 2 2 2 2 1 1 1 3 3 1 3 2 0 0 2 3 1 0 0 1 0 0 0 2 1 0 2 1 0 2 0 0 0 3 0 1 2 3 3 1 0 0 0 0 2 0 0 3 0 0 2 1 3 3 1 0 2 2 1 0 0 0 0 3 3 1 3 1 1 2 2 3 2 1 1 3 2 2 3 0 0 3 0 0 0 0 3 1 2 2 2 3 2 0 0 1 3 1 1 0 0 0 3 3 2 3 1 3 3 3 3 0 0 1 1 0 2 1 0 2 1 1 3 3 2 0 3 3 0 0 3 0 1 0 0 2 2 2 2 2 1 0 0 0 0 0 2 3 1 3 3 1 3 3 3 3 3 3 3 3 3 2 3 3 0 3 2 3 2 1 1 1 1 1 2 3 3 1 2 3 3 1 1 2 1 3 3 1 3 2 1 2 0 2 1 0 1 3 3 3 1 1 0 0 3 3 0 0 3 2 2 1 3 0 0 2 2 3 2 1 1 3 3 1 1 3 0 2 1 1 1 2 2 0 0 0 0 0 0 3 0 3 2 2 2 1 2 2 3 2 1 2 2 0 0 0 1 0 0 0 0 1 1 0 0 0 1 2 1 2 0 3 1 1 1 0 0 2 1 2 2 0 0 0 1 1 2 2 2 1 1 2 1 1 1 1 0 0 3 3 2 2 1 2 0 3 1 2 2 1 2 1 1 2 1 2 1 2 2 3 1 3 1 3 0 2 1 2 3 0 3 2 1 2 1 2 1 1 0 0 1 1 3 1 0 2 0 1 0 3 3 3 3 3 2 1 0 3 0 0 0 1 1 3 3 1 3 3 1 3 2 2 0 3 1 1 3 0 0 2 3 1 1 2 3 1 0 2 1 1 1 3 2 1 2 2 1 2 1 3 2 1 3 0 1 3 1 0 1 2 1 0 0 1 2 3 2 3 2 3 3 3 3 1 1 2 1 2 0 1 3 2 2 1 0 0 1 1 0 1 2 0 0 0 1 1 3 2 1 0 1 0 0 2 3 2 3 2 1 2 2 0 2 1 1 2 1 1 2 1 2 2 2 0 2 0 0 0 1 2 2 1 0 1 1 3 1 1 1 3 3 0 1 2 1 0 0 0 2 0 0 3 3 3 1 2 3 3 3 2 1 1 0 1 1 1 0 3 3 0 3 1 2 1 3 2 3 1 1 2 0 2 0 0 0 2 0 2 3 2 0 1 3 0 0 3 0 3 2 1 0 3 3 3 2 3 2 3 1 1 1 1 3 0 0 0 3 2 2 0 0 2 3 3 2 1 2 3 3 3 3 2 3 1 1 2 1 1 3 0 1 0 1 2 0 1 0 3 3 1 2 1 1 2 3 1 2 1 0 0 0 0 0 3 1 1 3 1 1 3 1 0 0 2 0 0 2 1 2 3 1 3 1 1 1 2 2 2 2 2 1 3 3 2 1 3 3 2 3 1 1 1 1 1 1 3 3 3 2 3 1 1 2 3 2 3 3 2 3 2 1 1 1 3 0 1 2 3 0 1 3 3 3 2 3 3 0 1 2 1 2 1 3 3 3 3 3 3 0 2 0 1 2 3 1 3 1 1 2 0 0 3 1 3 2 1 2 2 3 1 3 1 0 3 2 3 1 3 0 2 0 1 1 2 0 0 2 3 2 1 3 1 3 1 1 1 1 3 3 0 0 0 0 2 3 3 2 0 0 3 1 0 0 1 1 1 2 2 3 0 2 3 1 1 1 3 2 2 1 2 1 1 2 3 1 3 3 1 3 1 2 2 1 1 1 2 1 1 3 2 1 3 0 0 1 1 1 3 3 0 0 2 2 1 0 0 0 0 1 0 0 2 0 0 0 3 1 0 3 1 1 0 0 0 0 3 3 3 1 1 3 1 1 3 1 2 1 1 2 3 2 2 1 0 0 1 3 0 0 0 0 0 3 1 1 1 2 1 2 2 1 2 2 1 3 0 2 3 3 2 2 3 2 1 3 1 0 0 1 0 1 3 2 2 0 1 1 3 3 3 1 2 1 3 0 2 1 0 0 2 2 2 0 0 3 3 3 3 1 2 3 1 1 1 1 2 1 1 3 0 2 2 3 3 3 0 1 3 2 1 2 0 1 2 0 0 3 3 1 0 2 1 1 2 0 1 0 1 3 1 0 0 3 3 2 1 2 0 3 2 1 1 3 1 1 0 0 0 1 1 3 3 0 2 1 0 2 3 1 1 3 1 1 3 1 2 3 3 1 1 3 3 3 1 1 3 3 2 3 2 2 0 2 2 2 3 2 3 1 0 0 1 2 3 1 2 0 3 3 1 1 3 3 2 2 2 2 1 1 1 1 2 2 1 1 0 1 1 0 1 1 0 1 1 0 3 3 3 2 0 1 1 2 3 3 1 3 1 2 3 3 3 3 0 3 3 3 3 2 0 0 0 1 1 0 0 2 3 3 3 2 1 3 2 2 1 2 2 1 0 0 2 3 1 3 2 3 2 1 3 3 0 2 2 0 0 2 3 0 0 2 3 3 0 1 2 0 3 1 1 1 2 3 1 3 1 2 0 1 1 0 2 3 0 2 1 1 1 3 0 1 1 0 1 1 3 1 3 3 1 3 2 0 2 2 0 0 0 1 2 1 2 1 1 2 1 1 1 3 3 3 3 3 2 1 0 3 2 3 3 3 2 0 1 2 1 3 3 3 3 3 0 0 0 0 0 1 0 3 2 0 0 3 3 2 2 1 1 3 3 3 3 3 3 3 0 3 3 3 2 3 3 1 1 3 1 3 1 1 1 3 1 1 1 2 0 0 0 2 2 1 3 0 0 1 0 3 0 0 1 2 2 1 1 2 1 2 1 1 3 3 2 2 3 1 1 3 1 3 3 3 1 3 1 0 3 3 3 1 3 2 0 3 1 0 1 3 3 0 1 0 1 1 2 1 3 1 2 2 2 2 2 2 2 1 1 2 2 3 3 0 2 1 0 1 1 2 1 1 0 1 0 0 0 0 0 1 3 0 1 0 1 0 2 1 3 1 0 1 0 3 0 1 1 3 0 2 0 0 0 3 3 3 3 0 3 1 1 0 0 1 2 0 0 0 0 2 0 2 0 2 0 0 0 0 1 1 3 1 2 3 3 2 3 0 0 1 3 1 3 3 1 0 1 3 3 3 3 0 3 1 1 1 0 1 3 1 0 0 0 1 0 0 1 3 1 3 3 1 2 2 1 0 0 1 1 0 1 3 3 2 1 3 3 3 0 0 3 1 0 0 0 0 1 2 3 3 3 2 2 2 1 1 3 2 1 1 1 2 0 0 0 0 0 2 1 0 2 1 0 1 3 1 1 3 3 3 3 1 3 1 2 2 0 2 2 3 0 1 2 2 0 2 3 3 1 0 3 1 1 1 3 3 0 3 2 3 3 0 3 1 0 0 0 0 1 0 2 2 0 2 1 2 0 0 0 3 2 3 1 3 1 3 0 3 1 0 3 3 3 1 1 2 0 0 0 0 3 1 3 1 0 2 2 3 0 2 2 3 2 1 1 1 1 1 1 2 0 0 3 1 3 1 0 0 0 0 0 0 2 0 0 1 0 0 1 2 0 0 0 1 3 3 3 3 2 2 1 2 3 3 1 0 0 0 0 1 1 0 3 3 3 3 2 0 0 0 0 0 0 1 0 0 0 3 1 3 1 2 1 1 1 2 2 1 2 3 3 2 1 3 1 1 3 2 0 0 2 2 3 3 2 3 3 3 3 0 2 3 1 1 1 0 3 3 3 3 1 1 2 1 1 2 1 1 1 2 1 1 1 3 3 2 0 0 3 3 0 0 3 2 1 0 2 0 2 0 3 0 0 3 1 3 3 3 2 3 1 3 3 3 3 2 3 2 1 1 0 0 0 0 2 2 1 3 1 3 0 3 3 3 3 3 1 0 0 0 1 2 2 1 3 0 1 3 3 1 1 3 2 1 1 2 0 1 1 2 0 1 3 0 3 2 1 1 1 1 3 3 2 2 1 2 0 0 3 3 3 3 1 0 1 2 1 1 2 0 1 1 0 1 0 1 0 0 3 0 2 1 2 0 3 1 0 0 1 2 2 2 3 0 2 0 0 2 0 1 0 1 0 0 3 3 1 3 2 3 1 2 0 3 3 2 2 2 3 1 3 3 3 3 1 2 3 1 3 3 1 0 0 2 2 2 3 2 2 1 2 1 0 3 3 1 1 3 1 3 2 2 1 1 1 2 1 1 1 3 2 1 0 0 0 2 2 2 3 3 3 3 1 1 1 1 0 0 2 3 3 3 3 1 2 0 1 1 3 1 3 3 1 1 1 1 1 3 0 0 1 0 3 2 3 3 3 0 2 2 0 0 3 0 1 0 0 2 2 0 3 2 2 1 1 3 2 3 1 3 3 1 1 0 0 1 1 1 3 3 3 0 0 0 0 0 1 3 2 3 1 1 2 3 1 3 3 2 1 2 1 1 1 3 3 2 1 1 3 0 2 3 1 2 1 3 1 1 0 0 2 1 1 0 0 1 0 0 0 3 2 0 0 2 2 0 1 0 0 0 0 0 0 0 3 3 3 3 2 1 2 1 1 3 2 2 3 2 2 2 2 3 1 2 2 1 2 2 1 1 1 1 2 2 3 3 2 0 0 2 1 0 1 3 1 2 3 3 3 3 2 1 1 3 1 0 3 0 0 3 3 1 1 3 3 1 3 3 3 2 3 1 3 3 1 1 1 1 2 1 3 3 1 2 3 3 1 2 2 1 1 2 1 1 3 3 3 1 1 3 0 0 3 1 3 3 3 3 1 0 0 3 2 2 2 1 0 0 3 1 0 2 3 3 1 0 1 3 3 2 3 1 2 0 1 0 1 0 0 3 0 3 0 2 3 0 0 2 2 1 0 1 3 1 3 3 1 3 1 1 2 2 3 2 3 3 0 2 0 3 0 0 0 2 2 0 0 0 1 0 0 1 3 2 3 3 2 0 0 0 0 3 3 0 0 0 0 0 1 0 3 0 1 0 0 0 0 3 2 0 3 3 3 3 1 3 1 2 3 1 1 0 2 0 3 2 2 1 1 1 3 1 3 0 3 2 1 1 1 1 2 1 0 0 0 1 1 0 0 0 0 1 0 2 0 0 0 2 3 0 2 3 2 1 2 1 1 0 1 0 0 2 0 0 3 1 2 2 2 0 0 2 0 0 3 3 0 0 0 0 3 1 1 2 3 3 1 3 0 3 1 1 0 3 3 3 3 3 2 2 1 0 0 0 0 0 0 0 0 0 0 1 3 1 3 3 1 2 2 2 2 0 0 1 2 3 3 2 3 2 2 2 3 2 0 1 1 1 0 0 0 0 0 0 0 3 0 0 0 3 1 3 3 3 0 0 0 1 3 1 2 1 1 1 1 1 0 3 0 1 0 0 1 0 0 3 1 3 2 0 3 0 1 1 0 0 3 1 1 1 3 2 1 3 2 3 1 2 3 0 3 3 3 1 2 3 3 0 0 0 2 0 0 0 2 3 2 1 1 3 1 0 0 0 1 0 0 1 3 1 0 1 0 0 0 0 3 2 1 3 0 1 0 1 0 0 1 2 1 2 2 1 3 0 0 0 3 0 2 1 3 0 0 2 2 3 1 3 0 3 1 0 0 1 2 1 1 2 2 1 1 1 1 2 0 2 1 2 2 1 0 1 1 1 3 0 0 2 0 3 0 1 0 0 0 2 2 3 2 3 2 2 3 1 1 0 1 3 3 1 1 1 2 1 2 3 0 0 3 3 1 1 3 2 1 3 1 3 3 1 3 2 0 0 0 2 3 1 2 0 2 1 1 1 1 0 1 3 3 3 3 0 0 0 3 3 3 3 0 3 2 1 2 3 1 2 3 1 1 1 2 1 1 3 0 0 1 1 0 0 0 2 3 3 2 1 1 2 1 2 1 2 2 1 1 3 0 1 3 2 3 0 1 0 3 3 0 3 3 1 1 3 3 3 2 1 2 1 0 2 3 3 1 2 2 2 0 1 0 1 3 1 2 3 3 2 0 3 1 2 3 2 0 3 3 2 1 3 1 1 3 0 2 0 0 0 3 2 0 0 0 0 0 0 0 1 1 2 2 3 2 2 2 2 3 3 1 1 3 3 0 3 0 0 0 0 0 0 0 0 1 3 1 0 0 0 0 3 2 3 3 1 0 3 3 1 2 2 3 0 1 0 0 3 1 2 0 0 0 3 1 3 1 3 2 2 1 2 3 2 3 1 0 0 1 3 3 2 1 2 0 0 0 0 2 1 1 1 0 0 3 3 2 0 1 2 2 3 2 1 2 2 3 1 1 3 1 3 1 0 0 2 0 3 2 1 1 3 0 2 2 1 1 3 2 3 0 0 0 0 0 0 0 0 2 2 0 0 3 1 3 1 3 3 3 3 3 2 3 3 0 0 0 0 1 2 1 0 0 0 0 2 2 0 0 0 3 3 1 3 3 3 2 1 1 1 2 3 0 0 3 1 3 0 3 2 1 0 1 1 1 0 2 3 1 2 3 3 2 2 3 3 0 0 1 1 3 3 3 3 0 3 0 0 0 0 3 2 3 2 1 0 2 2 1 0 2 2 0 1 1 1 1 2 1 1 2 2 2 2 0 1 0 0 0 1 3 2 2 1 3 0 3 3 3 1 1 1 2 2 1 0 3 3 3 1 1 3 1 0 0 1 2 3 3 0 2 0 0 0 2 2 2 1 2 1 0 1 1 2 0 0 1 0 0 3 3 1 1 3 3 1 1 0 0 0 0 0 0 1 3 3 0 3 2 0 1 3 0 1 3 3 3 3 0 0 0 3 0 3 2 3 3 2 0 1 1 0 0 0 3 1 3 0 1 3 3 1 1 1 1 0 1 0 1 3 3 1 2 1 1 1 1 3 3 2 3 2 2 2 2 3 3 1 1 0 0 0 0 1 2 1 0 1 0 0 1 0 0 0 1 0 0 2 2 0 3 3 2 1 2 3 3 3 0 2 3 3 2 2 0 0 1 2 1 1 0 3 1 1 1 3 1 1 3 2 1 3 3 0 2 0 2 2 1 1 1 3 3 3 3 3 3 0 3 2 0 1 2 3 0 0 1 1 2 0 0 0 3 1 3 3 1 2 2 2 0 0 3 2 0 0 0 2 0 2 1 3 2 2 0 1 0 2 1 3 0 2 1 2 3 2 1 1 1 2 1 0 3 3 3 3 2 0 1 3 3 3 3 2 1 1 1 1 2 1 3 1 3 1 3 2 1 3 3 1 3 1 0 0 3 3 2 3 3 1 3 2 1 3 3 2 3 3 0 1 1 1 1 0 1 1 1 2 1 3 2 3 2 3 3 2 3 2 2 3 0 0 1 2 0 1 0 2 0 3 0 2 2 1 3 2 2 2 0 1 2 1 3 1 3 3 2 2 2 0 0 0 0 0 3 3 3 3 3 0 0 0 1 1 1 0 2 3 0 0 2 1 3 2 3 1 1 0 0 2 0 0 3 2 3 3 2 3 1 1 2 1 0 3 2 2 1 1 3 2 0 2 1 3 1 0 0 2 1 2 3 0 3 2 1 3 0 0 2 2 1 2 0 2 0 1 1 0 3 0 1 2 1 1 2 3 1 0 0 0 1 1 1 3 2 3 1 0 0 0 0 2 3 3 3 0 2 3 2 2 1 0 3 0 3 2 2 0 3 0 0 0 0 2 3 2 1 1 1 0 0 3 2 3 2 3 2 2 2 3 3 2 3 1 1 1 3 0 2 1 1 0 0 1 3 1 1 0 3 3 1 0 1 0 2 3 1 0 0 2 0 0 0 1 3 3 2 0 0 2 3 3 0 3 0 2 2 0 0 3 0 0 0 0 0 2 0 0 0 0 0 0 1 0 0 3 3 1 1 2 3 0 0 0 0 0 0 1 1 1 1 0 0 2 0 3 1 3 1 2 2 1 0 2 1 3 0 0 1 1 1 3 1 2 2 3 2 2 3 2 1 3 3 0 0 0 2 2 3 1 2 1 3 3 1 1 3 2 3 1 1 2 3 1 2 1 3 0 0 1 3 3 2 3 0 3 3 1 2 1 2 1 1 2 1 0 0 0 0 0 0 0 0 0 0 0 2 0 2 3 3 1 0 3 2 1 2 1 1 1 3 0 0 0 1 1 2 1 2 3 3 3 3 1 1 0 2 1 3 1 1 1 0 1 1 1 1 2 2 1 0 3 3 3 3 2 2 1 1 0 0 0 1 0 0 0 1 2 0 1 0 2 2 3 0 1 3 3 1 0 0 1 1 3 2 2 2 1 3 2 3 3 1 0 0 0 1 0 0 3 2 0 0 2 3 2 3 1 2 0 0 2 1 0 1 0 0 3 1 3 0 1 0 0 3 0 2 2 1 3 1 3 2 1 1 1 1 1 2 1 3 2 0 3 1 2 1 2 2 2 1 2 2 2 1 2 3 3 2 2 3 2 1 2 3 1 1 1 1 3 3 1 1 3 2 0 0 3 3 1 3 2 2 0 2 0 0 0 1 0 3 3 3 3 2 3 2 1 2 1 2 1 2 3 2 2 3 2 1 1 2 1 2 2 3 2 1 0 3 3 2 2 1 1 1 0 0 0 2 2 1 3 1 0 0 3 3 2 1 2 2 0 3 1 3 3 0 2 0 0 1 0 3 3 3 1 3 1 3 1 2 0 2 1 0 0 1 3 1 3 0 2 3 3 2 2 3 0 0 0 0 1 3 2 0 2 1 0 1 1 2 3 3 2 2 3 1 1 3 2 1 1 1 2 3 3 2 2 2 3 3 1 0 1 2 2 1 2 0 0 0 3 0 3 1 2 2 0 3 0 1 1 2 1 0 2 1 1 2 2 0 1 0 1 0 0 2 0 0 1 1 3 3 0 1 1 2 3 3 3 0 0 0 1 1 1 0 0 0 0 3 3 1 1 1 1 3 0 3 3 0 1 1 3 0 2 0 0 0 0 0 0 1 1 0 0 0 3 2 2 3 3 2 3 0 0 3 3 0 2 1 1 1 0 0 1 0 0 2 0 0 3 0 0 0 0 2 3 3 2 3 2 3 2 0 1 0 2 0 1 3 3 3 2 0 2 1 1 1 2 3 2 0 0 1 0 2 2 0 0 3 1 3 3 2 3 3 1 0 1 0 1 2 1 3 3 3 3 2 0 2 0 0 3 2 3 3 3 0 2 1 0 0 0 3 1 0 1 3 0 0 0 0 0 1 1 0 2 3 1 2 3 2 1 0 1 2 0 0 0 3 1 2 1 1 3 1 3 0 1 2 3 2 1 0 2 2 2 0 1 2 3 0 0 0 0 2 0 0 0 3 1 2 3 3 3 1 0 3 3 0 2 2 0 2 2 1 3 1 1 2 2 0 0 1 2 0 1 2 0 0 2 0 0 0 3 3 1 3 3 2 1 3 2 2 2 2 3 2 1 2 2 0 0 1 0 0 0 3 3 2 1 2 0 2 2 2 3 2 3 1 1 2 1 2 0 1 1 2 0 0 2 3 3 0 0 0 0 0 0 0 0 0 0 1 0 0 3 2 2 3 1 1 1 0 2 1 2 3 1 2 1 0 0 2 2 0 0 0 0 3 0 0 0 2 0 0 0 1 1 1 1 2 3 3 1 1 1 1 2 2 3 3 2 2 0 3 2 1 2 3 1 0 2 0 1 1 2 0 0 2 3 1 3 1 0 2 3 3 0 0 0 3 3 1 3 0 0 1 2 2 0 3 3 3 3 0 0 3 2 1 1 0 0 0 0 2 3 0 3 1 1 0 0 2 2 2 0 0 3 3 3 3 3 0 3 3 0 0 2 0 1 3 3 3 0 0 0 2 3 0 0 1 0 0 0 3 3 0 0 3 2 1 3 2 3 2 0 3 2 3 0 2 1 3 3 2 3 2 2 1 0 1 3 2 3 0 2 2 0 0 3 1 2 0 2 0 0 0 1 3 3 2 1 0 1 2 1 1 3 3 3 3 3 1 0 3 2 2 1 1 2 3 1 3 1 2 0 0 1 3 2 0 2 3 1 3 2 1 2 2 0 0 0 3 0 2 1 2 1 2 0 1 0 0 0 1 2 0 0 0 2 2 3 3 2 0 0 2 1 0 0 1 1 3 2 1 1 2 3 3 3 0 2 1 0 2 0 0 2 2 3 0 0 1 3 2 0 0 3 1 1 2 3 0 2 1 2 0 0 3 3 3 3 0 1 0 2 3 2 2 0 1 0 1 1 3 3 3 0 0 0 3 3 1 2 1 1 1 2 2 2 0 1 0 0 1 0 0 0 1 3 3 3 1 0 0 3 3 2 3 0 3 3 3 0 1 1 3 1 1 0 1 2 3 1 0 1 1 3 2 1 2 0 1 3 0 0 0 2 3 3 3 3 3 3 3 3 3 1 0 1 0 0 3 1 2 2 3 2 0 3 3 3 1 2 2 3 3 3 2 3 3 3 1 2 2 1 1 1 2 2 2 3 0 1 2 3 1 3 1 1 0 1 2 3 0 0 0 0 0 2 2 1 1 1 3 1 2 2 2 2 2 2 1 1 1 1 1 1 3 1 1 1 3 0 0 0 1 1 3 0 1 1 0 0 0 3 3 1 0 0 3 3 3 3 1 3 2 1 1 2 0 1 2 1 1 2 1 3 2 1 3 3 1 0 2 2 3 1 3 3 3 0 3 1 3 1 0 0 0 0 0 0 3 0 1 3 3 1 2 1 3 2 2 2 1 1 2 2 0 3 3 1 2 3 1 1 2 2 1 1 0 1 3 2 3 3 3 1 2 3 1 1 2 2 1 0 1 2 1 2 3 3 2 3 2 2 2 2 3 3 2 1 2 0 2 0 0 0 3 1 1 1 3 3 3 1 1 2 3 3 1 0 3 1 3 1 3 1 1 2 2 1 1 0 1 1 0 2 0 0 0 3 3 3 0 0 1 3 3 2 0 1 3 0 1 2 0 0 3 3 2 2 3 3 2 3 3 1 1 1 2 2 1 0 3 3 2 1 1 3 3 3 3 0 0 3 2 0 0 0 0 1 0 3 1 1 3 0 3 0 3 2 3 3 0 2 0 0 3 1 3 0 0 3 3 2 3 1 1 2 3 1 0 0 3 2 1 1 1 1 2 3 1 0 0 0 0 0 1 0 0 1 3 1 1 2 2 3 2 2 1 1 1 2 2 2 1 0 2 1 1 3 1 1 2 1 3 3 3 1 1 3 1 3 1 2 2 2 3 1 3 1 1 2 2 2 2 3 3 2 3 2 0 0 2 1 1 1 1 1 1 3 0 0 3 1 2 3 1 0 2 1 2 3 0 3 1 0 1 0 0 1 2 3 1 0 3 2 1 3 3 1 0 1 3 1 3 1 0 0 3 2 1 1 2 0 0 1 0 0 0 2 1 2 3 3 3 1 0 1 3 3 3 1 0 3 3 1 2 1 1 0 2 3 1 2 3 1 2 0 0 0 1 0 2 3 3 3 3 1 0 1 0 3 2 1 0 0 3 1 3 2 0 1 0 0 0 1 0 0 1 1 1 2 0 0 0 1 0 0 0 0 0 0 1 0 0 0 1 2 3 1 1 3 0 0 1 1 2 1 3 0 0 0 0 0 2 2 1 0 3 0 3 1 0 2 0 2 1 2 1 0 2 2 3 2 0 0 0 1 2 2 1 0 0 2 2 0 1 0 0 3 2 2 2 1 1 2 3 3 1 1 2 3 1 3 1 0 0 0 0 0 3 3 3 3 3 3 3 3 3 0 0 0 1 0 0 2 3 1 1 0 3 1 0 0 1 1 3 3 0 2 0 0 0 1 0 0 2 3 3 2 2 0 2 0 0 1 3 1 3 1 0 3 3 1 3 1 3 3 1 1 2 0 3 1 1 2 2 2 3 3 3 2 0 0 0 3 1 0 1 1 1 1 2 3 3 1 3 2 2 3 0 2 1 3 3 3 2 3 0 1 2 1 3 1 3 0 2 2 1 2 1 0 1 3 2 0 1 1 3 1 3 2 3 3 3 1 3 1 0 2 1 1 3 1 2 2 0 3 3 3 3 1 3 3 0 1 0 0 3 3 3 0 1 1 0 0 3 2 1 1 0 2 2 3 0 2 2 2 2 0 0 0 0 3 3 3 1 0 0 1 0 1 0 0 2 3 0 2 0 3 3 2 3 0 1 0 2 1 1 3 2 2 1 1 0 1 0 0 0 0 2 0 3 0 1 3 1 2 2 1 3 3 3 2 0 2 3 1 2 0 1 1 2 0 0 0 0 0 0 0 3 3 0 2 2 1 0 0 3 3 3 1 3 1 1 0 2 1 3 2 3 3 1 1 1 2 3 2 3 3 0 0 0 3 0 0 1 0 0 2 3 3 3 0 2 1 1 2 2 3 3 1 3 0 3 3 3 1 3 0 1 2 1 0 0 0 3 3 3 1 3 3 3 1 0 2 1 2 0 0 3 2 0 1 0 3 0 1 0 0 1 0 0 3 3 1 1 2 1 1 1 3 3 1 2 1 2 2 0 0 0 2 3 3 0 2 1 3 2 2 3 3 3 1 3 1 3 1 2 3 3 3 2 1 3 1 0 3 3 3 1 1 3 2 2 2 2 1 1 1 2 0 0 3 3 3 1 0 0 0 0 0 1 0 0 1 1 3 1 2 3 1 3 3 1 3 1 1 2 3 3 0 2 2 1 1 1 1 1 2 2 2 1 1 0 0 0 0 2 0 3 2 1 2 1 3 3 3 1 2 3 1 0 0 3 3 3 3 3 3 0 0 2 0 1 1 0 0 1 3 3 3 1 0 1 0 0 2 3 0 2 2 0 0 3 3 2 2 1 1 1 2 2 2 2 1 0 0 0 3 1 1 1 3 2 1 2 0 3 1 1 2 1 2 1 2 1 1 2 0 1 1 0 0 3 1 3 3 2 1 3 3 3 0 0 3 1 1 1 0 0 2 1 0 0 3 0 0 0 1 2 0 0 1 2 3 3 0 1 0 0 0 1 2 1 1 3 0 2 2 2 1 3 3 3 2 3 2 2 0 3 2 3 1 0 0 0 2 3 3 3 3 2 1 3 0 0 2 2 3 3 2 1 3 2 1 3 2 3 3 2 0 1 1 1 2 2 3 2 3 3 2 1 1 3 0 2 0 0 3 3 3 1 0 1 2 3 2 1 2 2 2 2 3 1 1 0 0 3 3 3 2 1 0 0 1 0 0 0 0 1 2 1 2 1 3 0 0 0 0 2 1 3 2 2 1 1 0 3 0 2 2 1 1 2 1 3 3 2 3 2 2 0 0 1 0 2 1 3 2 1 3 2 0 0 3 3 3 1 2 3 3 0 1 1 0 1 0 1 3 0 2 2 1 1 0 0 0 1 0 1 1 3 3 1 1 1 1 2 2 2 3 3 3 3 3 0 1 3 2 1 1 1 2 2 0 2 0 0 0 3 3 3 3 3 2 3 0 1 1 2 2 3 0 3 2 3 0 3 1 2 1 2 3 1 3 3 2 2 3 1 1 1 2 3 1 0 0 0 1 1 1 2 2 1 1 0 0 3 1 2 2 1 3 2 3 3 3 3 3 3 3 3 3 1 0 3 3 0 0 3 0 1 0 0 0 1 0 0 3 3 2 1 1 0 2 2 3 2 0 3 3 2 1 3 0 0 1 0 2 0 2 0 1 3 0 0 3 3 1 2 2 3 2 0 0 1 0 1 1 1 1 2 0 0 2 3 2 1 3 3 1 1 1 2 1 1 0 0 2 1 2 1 0 0 0 1 1 3 2 3 0 1 3 1 1 3 0 2 0 2 3 3 2 1 1 1 0 1 0 2 3 1 0 0 2 3 2 0 3 1 3 2 1 2 1 3 2 2 1 1 3 1 2 0 0 0 0 3 3 3 3 3 2 0 1 1 1 2 2 1 1 0 2 2 3 1 2 1 2 3 3 0 0 2 1 1 2 1 3 1 3 3 3 0 0 3 1 3 3 0 0 2 3 3 2 3 1 1 2 1 1 2 1 3 2 3 0 3 2 2 2 2 1 1 3 1 1 3 3 3 2 2 1 3 1 0 0 0 3 3 0 1 1 3 3 3 1 3 3 1 3 0 0 0 0 0 0 2 3 1 3 3 3 0 3 3 0 1 3 1 1 0 3 3 1 0 2 3 1 1 3 0 3 0 0 0 1 2 3 2 1 3 1 3 1 1 3 2 0 1 1 1 2 2 1 3 0 3 1 1 1 0 1 3 3 3 1 2 1 1 0 3 3 1 0 3 3 1 1 1 3 1 3 3 2 2 0 3 2 0 2 1 3 0 3 1 2 3 2 2 2 1 3 2 0 0 3 0 0 0 2 2 3 1 1 1 2 0 3 2 1 3 3 3 2 2 2 1 1 2 0 0 2 3 3 1 0 3 0 1 0 2 0 0 0 2 0 0 0 0 0 2 2 2 1 0 1 3 0 3 1 0 3 2 0 2 1 3 0 3 0 3 2 2 2 0 2 2 3 1 3 3 0 0 3 3 2 3"

def init_Model_Matrix(n_row, n_col):
    '''
    generate the initial A, B, pi
    And ensure that the sum of prob in the row equal to 1
    '''
    input_data = [n_row, n_col]
    for i in range(n_row):
        Init = [(1 / n_col) + np.random.rand() / 1000 for _ in range(n_col)]
        s = sum(Init)
        input_data += [j / s for j in Init]
    return Matrix(input_data)

def init_Model(n_state, n_obs):
    A = init_Model_Matrix(n_state, n_state)
    B = init_Model_Matrix(n_state, n_obs)
    # print(B.get_input_list())
    pi = init_Model_Matrix(1, n_state)
    A.trans_to_matrice()
    B.trans_to_matrice()
    pi.trans_to_matrice()
    return HMM(A, B, pi)

if __name__ == '__main__':

    A = Matrix("3 3 0.7 0.05 0.25 0.1 0.8 0.1 0.2 0.3 0.5".split())
    B = Matrix("3 4 0.7 0.2 0.1 0 0.1 0.4 0.3 0.2 0 0.1 0.2 0.7".split())
    pi = Matrix("1 3 1 0 0".split())
    obs_seq = Matrix(OBS_10k.split(),isvector=True)
    

    #MODEL = init_Model(n_state= 8, n_obs= 4)
    MODEL = HMM(A,B,pi)
    MODEL.model_para_learn(obs_seq, 500)
    
    AA = []
    BB = []
    for i in MODEL.get_trans_M():
        AI = []
        for j in i:
            AI.append(round(j,3))
        AA.append(AI)
    
    for i in MODEL.get_obs_M():
        BI = []
        for j in i:
            BI.append(round(j,3))
        BB.append(BI)

    print(AA)
    print(BB)
    #print("The p of observation sequence: " + str(1000000 * MODEL.alpha_pass_no_scale(obs_seq)))
    #print(A.n_row, A.n_col, ' '.join(map(str, A.input_list)))
    #print(B.n_row, B.n_col, ' '.join(map(str, B.input_list)))

